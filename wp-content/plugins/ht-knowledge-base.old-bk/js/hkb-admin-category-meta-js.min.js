jQuery(document).ready(function(a){"use strict";function b(){a("input#meta-image").val(""),a("#meta-image-preview").attr("src",n.no_image)}function c(){b(),a("#meta-image-preview").hide()}function d(){f(),a("#meta-image-preview").show()}function e(){a("input#meta-svg").val(""),a("input#meta-svg-color").val(""),a("#ht-kb-svg-preview").html("")}function f(){e(),a("#ht-kb-svg-preview").hide()}function g(){c(),a("#ht-kb-svg-preview").show()}function h(){a("button.media-button-select").on("change",function(a){a.preventDefault()}),a("button.media-button-select").prop("disabled",!1)}function i(){a("li.ht-kb-icon.active").removeClass("active")}function j(){var b=a("li.ht-kb-icon.active").html();return b}function k(){var b=a(".icon-color").val();return b}function l(b){a(".hkbiconsvg-stroke").css("stroke",b),a(".hkbiconsvg-fill").css("fill",b)}function m(){a(".icon-color").wpColorPicker({change:function(b,c){var d=(b.target,c.color.toString());l(d),a(".icon-color").val(d)}})}var n=window.meta_image,o=window.wp;a("#meta-image-button").click(function(b){b.preventDefault(),"undefined"!=typeof o&&o.media&&o.media.editor&&o.media.editor.open("meta-image-button"),window.currentEditor=o.media.editor.get("meta-image-button");o.media.editor.send.attachment;o.media.editor.send.attachment=function(b,c){if(c.hasOwnProperty("id")&&(a("input#meta-image").val(c.id),d(),c.hasOwnProperty("sizes"))){var e=c.sizes,f=null;e.hasOwnProperty("thumbnail")?(f=e.thumbnail.url,a("#meta-image-preview").attr("src",f)):(f=e.full.url,a("#meta-image-preview").attr("src",f))}},window.original_send_to_editor=window.send_to_editor,window.send_to_editor=function(a){}}),a("#meta-image-remove").click(function(a){a.preventDefault(),b(),d()}),a(".meta-color").wpColorPicker(),""!==a("input#meta-svg").val()?g():d(),a("form#addtag input#submit").click(function(a){a.preventDefault(),b(),d()}),a(document.body).on("click","#meta-image-button",function(b){var c=0;if(0===c){var d=n.activate_tab_text||"",e=a(".media-menu-item").filter(function(){return a(this).text().toLowerCase().indexOf(d.toLowerCase())>=0}).first();e.trigger("click"),c=1}}),a(document.body).on("click","li.ht-kb-icon",function(b){b.preventDefault(),i(),a(this).addClass("active"),h()}),a(document.body).on("click","button.media-button-select",function(b){g();var d=j(),e=k();a("#ht-kb-svg-preview").show(),a("#ht-kb-svg-preview").html(d),a("input#meta-svg").val(d),a("input#meta-svg-color").val(e),c(),window.currentEditor.close()});var p=(o.media.view.EmbedUrl,o.media.View),q=p.extend({tagName:"label",className:"add-ht-kb-icon",template:o.template("hkb-icons"),events:{input:"icon",keyup:"icon",change:"icon"},initialize:function(){this.model.get("icon")&&_.delay(_.bind(function(){this.model.trigger("change:icon")},this),500),this.render()},render:function(){return this.model.set("icon","test"),p.prototype.render.apply(this,arguments),m(),this},icon:function(a){this.model.set("icon","test"),console.log("icon model set")},focus:function(){var a=this.$input;a.is(":visible")&&a.focus()[0].select()}}),r=o.media.view.MediaFrame.Post;o.media.view.MediaFrame.Post=r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments);this.options;this.states.add([new o.media.controller.Embed({id:"ht-kb-icon",title:"Knowledge Base Icon",content:"icon"})]);var a;a={content:{icon:"iconContent"}},_.each(a,function(a,b){_.each(a,function(a,c){this.on(b+":render:"+c,this[a],this)},this)},this)},iconContent:function(){console.log("iconContent");var b=new q({controller:this,model:this.state()}).render();this.content.set(b);var c=a("input#meta-svg-color").val()||"#000";a(".icon-color").val(c);var d=k();l(d),m()},destroy:function(){console.log("destroyed")}})});