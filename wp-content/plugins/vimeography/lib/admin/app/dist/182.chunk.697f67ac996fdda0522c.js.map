{"version":3,"sources":["webpack://vimeography-admin/./src/providers/Themes.tsx","webpack://vimeography-admin/./src/context/Notification.ts","webpack://vimeography-admin/./src/providers/Notification.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/AppearanceEditor/Colorpicker.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/AppearanceEditor/Numeric.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/AppearanceEditor/Slider.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/AppearanceEditor/Visibility.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/AppearanceEditor/AppearanceEditor.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/BasicSettings/BasicSettings.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/ThemeList/ThemeList.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/ProSellPanel.tsx","webpack://vimeography-admin/./src/components/GalleryEditor/GalleryEditor.tsx","webpack://vimeography-admin/./src/hooks/useNotification.tsx","webpack://vimeography-admin/./src/pages/ListGalleries/DuplicateGallery.tsx","webpack://vimeography-admin/./src/pages/ListGalleries/GalleryRow.tsx","webpack://vimeography-admin/./src/pages/ListGalleries/Menu.tsx","webpack://vimeography-admin/./src/pages/ListGalleries/ListGalleries.tsx","webpack://vimeography-admin/./src/containers/App.tsx","webpack://vimeography-admin/./src/bootstrap.tsx","webpack://vimeography-admin/./src/context/Gallery.ts","webpack://vimeography-admin/./src/context/Themes.ts","webpack://vimeography-admin/./src/providers/Gallery.tsx"],"names":["initialState","themes","reducer","state","action","type","length","next","payload","findIndex","theme","name","themeName","settings","setting","id","settingId","draft","value","console","log","props","dispatch","useQuery","fetch","window","vimeographyApiSettings","root","then","res","json","isLoading","error","data","Themes","children","CLASSES","success","variants","hidden","y","opacity","visible","NotificationContainer","notifications","className","map","n","key","initial","animate","onClick","removeNotification","message","document","body","setNotifications","showNotification","filter","t","timers","setTimeout","timer","clearTimeout","Notification","setVisible","colorStr","setColorStr","ctx","style","backgroundColor","label","color","onChange","rgb","r","g","b","a","parseInt","setValue","defaultValue","min","max","step","formatter","val","Range","values","renderTrack","renderThumb","isDragged","checked","setChecked","e","isChecked","target","gallery","themesCtx","activeTheme","find","theme_name","maxHeight","background","thumbnail","textShadow","Link","to","fill","viewBox","xmlns","d","stroke","strokeLinecap","strokeLinejoin","strokeWidth","control","Control","Numeric","Slider","Visibility","Setting","SettingLabel","isRefreshing","setIsRefreshing","handleUpdate","cache_timeout","url","location","href","fillRule","clipRule","video_limit","placeholder","gallery_width","featured_video","formRef","themeFieldRef","ref","method","vimeographyThemeNonce","isActiveTheme","toLowerCase","current","submit","src","version","ProSettings","NavItem","NavLink","exact","activeClassName","Menu","open","height","closed","isSettingsPanel","useRouteMatch","path","strict","isAppearancePanel","galleryCtx","isProPanel","isExact","transition","duration","ease","bounce","Switch","Route","ErrorBoundary","FallbackComponent","fallback","Skeleton","phrase","set","task","setInterval","phrases","Math","floor","random","clearInterval","backgroundImage","GalleryEditorHeading","isEditing","setIsEditing","title","source_url","submitting","setSubmitting","styles","getElementById","innerText","mode","cache","credentials","headers","wpApiSettings","nonce","JSON","stringify","css","responseA","ok","reload","disabled","setTitle","source","setSource","copyAppearance","setCopyAppearance","queryClient","useQueryClient","mutation","useMutation","gallery_id","copy_appearance","onSuccess","invalidateQueries","transform","setDuplicateGalleryModalOpen","mutate","date_created","preventDefault","setGalleryToDuplicate","confirm","MenuItem","ProTools","NoGalleries","ProToolsAd","duplicateGalleryModalOpen","galleryToDuplicate","QueryClient","params","search","substring","get","page","isListGalleries","isEditGallery","QueryClientProvider","client","Gallery","appearanceRules","convertToDashedAttribute","attr","replace","computeValue","suffix","attribute","computedValue","properties","expressions","property","index","push","expression","calculatedValue","operator","ceil","eval","toString","rule","el","GalleryProvider","staleTime","Infinity","customStyle","dir","sheet","cssRules","prop","modifiedTarget","selectorToMatch","namespace","selectorText","getPropertyValue","searchTerm","tokenIndex","indexOf","terminator","substr","terminatorIndex","extractedValue","strippedValue","remove","join"],"mappings":"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","file":"182.chunk.697f67ac996fdda0522c.js","sourcesContent":["import * as React from \"react\";\nimport ThemesContext from \"../context/Themes\";\nimport { useQuery } from \"react-query\";\nimport produce from \"immer\";\n\ntype ThemesProviderProps = React.PropsWithChildren<{ id?: string }>;\n\n/** Defines which CSS selectors and properties that the setting will control.\n An array of one or more arrays, with each array containing two key/value pairs: */\nexport type ThemeSettingProperty = {\n  /** defines the CSS property that this setting will control for the corresponding target selector. */\n  attribute: string;\n\n  /** defines the CSS selector that the setting will affect */\n  target: string;\n\n  /** allows you to provide a string with a {{value}} token to define where the resulting pixel value should be injected in the generated CSS string value. */\n  transform?: string;\n};\n\n/**\n * Defines additional CSS selectors and properties that the setting will control,\n * but this time, relatively manipulating the value before associating it with the\n * selector. This is useful if you have two selectors whose values are linked and\n * change relative to one another (widescreen image ratios, margins etc.)\n */\nexport type ThemeSettingExpression = {\n  /** defines the CSS selector that the setting will affect */\n  target: string;\n  /** the CSS property that this setting will control for the target selector. */\n  attribute: string;\n  /** defines the symbol(s) to use for the mathmatical operation to perform on the original setting value. */\n  operator: ThemeSettingExpressionOperation;\n  /** is the input integer which acts as the addend, subtrahend, divisor, multiplier etc. to the original setting value. */\n  value: string;\n  /** allows you to provide a string with a {{value}} token to define where the resulting pixel value should be injected in the generated CSS string value. */\n  transform?: string;\n};\n\ntype ThemeSettingExpressionOperation = \"+\" | \"-\" | \"/\" | \"*\";\n\nexport type ThemeSettingType =\n  | \"colorpicker\"\n  | \"slider\"\n  | \"numeric\"\n  | \"visibility\";\n\n/** Contains all of the configurable settings for a theme. */\nexport type ThemeSetting = {\n  /** An arbitrary identifier string to associate with the UI control's form field. */\n  id: string;\n\n  /** The i18n-compatible label for this particular setting. */\n  label: string;\n\n  /**\n   * Whether or not the DOM element being targeted by the CSS is a child of the\n   * vimeography-gallery-{{gallery_id}} container. Usually TRUE, unless your theme\n   * uses a fancybox plugin, in which case, the modal window is outside of the container\n   * element, so FALSE would be appropriate.\n   */\n  namespace: boolean;\n\n  /** Whether or not this setting requires the Vimeography Pro plugin to be installed. TRUE if `type` is 'colorpicker', otherwise FALSE. */\n  pro: boolean;\n\n  /** The default CSS value for this setting. */\n  value: string;\n\n  /** Defines which CSS selectors and properties that the setting will control. */\n  properties: ThemeSettingProperty[];\n\n  /** The UI control to render for the current setting. */\n  type: ThemeSettingType;\n\n  /**\n   * Defines additional CSS selectors and properties that the setting will control,\n   * but this time, relatively manipulating the value before associating it with the\n   * selector. This is useful if you have two selectors whose values are linked and\n   * change relative to one another (widescreen image ratios, margins etc.)\n   */\n  expressions?: ThemeSettingExpression[];\n\n  /** If set to TRUE, the CSS rule will be saved with an `!important` flag. */\n  important?: boolean;\n\n  /** [required if `type` is 'slider' or 'numeric'] The minimum value that a CSS property can be set. */\n\n  min?: number;\n\n  /** [required if `type` is 'slider' or 'numeric'] The maximum value that a CSS property can be set. */\n\n  max?: number;\n\n  /** [required if `type` is 'slider' or 'numeric'] The increment/decrement value of the UI control. */\n  step?: number;\n};\n\nexport type Theme = {\n  name?: string;\n  description: string;\n  version: string;\n  thumbnail: string;\n  is_licensed: string;\n  settings: ThemeSetting[];\n};\n\nexport type ThemesState = {\n  themes?: Theme[] | [];\n};\n\ntype UpdateThemeSettingDefaultValuePayload = {\n  themeName: string;\n  settingId: string;\n  value: any;\n};\n\ntype Action =\n  | { type: `HYDRATE`; payload: Theme[] }\n  | { type: `RESET`; payload: Theme[] }\n  | {\n      type: `THEME.SETTING.UPDATE_DEFAULT_VALUE`;\n      payload: UpdateThemeSettingDefaultValuePayload;\n    };\n\nconst initialState: ThemesState = {\n  themes: [],\n};\n\nconst reducer = (state: ThemesState, action: Action) => {\n  switch (action.type) {\n    case \"HYDRATE\": {\n      if (state.themes.length > 0) return state; //only hydrate once\n\n      return produce(state, (next) => {\n        next.themes = action.payload;\n      });\n    }\n\n    case \"RESET\": {\n      return produce(state, (next) => {\n        next.themes = action.payload;\n      });\n    }\n\n    case `THEME.SETTING.UPDATE_DEFAULT_VALUE`: {\n      // console.log(action.payload);\n      const themeIndex = state.themes.findIndex(\n        (theme) => theme.name === action.payload.themeName\n      );\n      const settingIndex = state.themes[themeIndex].settings.findIndex(\n        (setting) => setting.id === action.payload.settingId\n      );\n\n      const nextState = produce(state, (draft) => {\n        draft.themes[themeIndex].settings[settingIndex].value =\n          action.payload.value;\n      });\n\n      return nextState;\n    }\n\n    default:\n      console.log(`unknown action type: ${action.type}`);\n      return state;\n  }\n};\n\nconst ThemesProvider = (props: ThemesProviderProps) => {\n  const [state, dispatch] = React.useReducer(reducer, initialState);\n\n  const { isLoading, error, data } = useQuery(`getThemes`, () =>\n    fetch(window.vimeographyApiSettings.root + `vimeography/v1/themes`)\n      .then((res) => {\n        return res.json();\n      })\n      .then((payload) => {\n        dispatch({ payload, type: \"HYDRATE\" });\n        return payload;\n      })\n  );\n\n  return (\n    <ThemesContext.Provider\n      value={{\n        isLoading,\n        error,\n        data,\n        state,\n        dispatch,\n      }}\n    >\n      {props.children}\n    </ThemesContext.Provider>\n  );\n};\n\nexport default ThemesProvider;\n","import * as React from \"react\";\n\nconst NotificationContext = React.createContext(null);\n\nexport default NotificationContext;\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { motion } from \"framer-motion\";\nimport { nanoid } from \"nanoid\";\n\nimport NotificationContext from \"../context/Notification\";\n\ntype Notification = {\n  message: string;\n  type: \"success\" | \"error\";\n};\n\nconst CLASSES = {\n  success: \"vm-text-green-500\",\n  error: \"vm-text-red-600\",\n};\n\nconst variants = {\n  hidden: {\n    y: 200,\n    opacity: 0,\n  },\n  visible: {\n    y: 0,\n    opacity: 1,\n  },\n};\n\nconst NotificationContainer = (props) => {\n  const notifications = props.notifications;\n\n  return ReactDOM.createPortal(\n    <div className=\"vm-absolute vm-bottom-5 vm-w-full vm-z-10 vm-flex vm-flex-col vm-items-center vm-justify-center\">\n      {notifications.map((n) => (\n        <motion.div\n          key={n.id}\n          variants={variants}\n          initial=\"hidden\"\n          animate=\"visible\"\n          onClick={() => props.removeNotification(n.id)}\n          className={`vm-bg-white vm-shadow-xl vm-p-4 vm-rounded vm-mb-3 vm-border vm-border-solid vm-border-gray-100 vm-font-semibold ${\n            CLASSES[n.type]\n          }`}\n        >\n          {n.message}\n        </motion.div>\n      ))}\n    </div>,\n    document.body\n  );\n};\n\nconst NotificationProvider = ({ children }) => {\n  const [notifications, setNotifications] = React.useState([]);\n\n  const showNotification = React.useCallback(\n    (type, message) => {\n      setNotifications((notifications) => [\n        ...notifications,\n        { id: nanoid(), message, type },\n      ]);\n    },\n    [setNotifications]\n  );\n\n  const removeNotification = React.useCallback(\n    (id) => {\n      setNotifications((notifications) =>\n        notifications.filter((t) => t.id !== id)\n      );\n    },\n    [setNotifications]\n  );\n\n  React.useEffect(() => {\n    const timers = notifications.map((n) => {\n      return setTimeout(() => {\n        removeNotification(n.id);\n      }, 3000);\n    });\n\n    return () => {\n      timers.map((timer) => clearTimeout(timer));\n    };\n  }, [notifications, removeNotification]);\n\n  return (\n    <NotificationContext.Provider\n      value={{ showNotification, removeNotification }}\n    >\n      <NotificationContainer\n        notifications={notifications}\n        removeNotification={removeNotification}\n      />\n      {children}\n    </NotificationContext.Provider>\n  );\n};\n\nexport default NotificationProvider;\n","import * as React from \"react\";\nimport { ChromePicker } from \"react-color\";\nimport GalleryContext from \"~/context/Gallery\";\nimport { ThemeSetting } from \"~/providers/Themes\";\n\ntype ControlProps = {\n  setting: ThemeSetting;\n};\n\nconst Colorpicker = (props: ControlProps) => {\n  const setting = props.setting;\n  const [visible, setVisible] = React.useState(false);\n  const [colorStr, setColorStr] = React.useState(setting.value);\n  const ctx = React.useContext(GalleryContext);\n\n  const handleChange = (color) => {\n    const colorStr = `rgb(${color.rgb.r} ${color.rgb.g} ${color.rgb.b} / ${\n      color.rgb.a\n    })`;\n\n    setColorStr(colorStr);\n\n    ctx.dispatch({\n      type: `UPDATE_GALLERY_APPEARANCE`,\n      payload: { ...setting, value: colorStr },\n    });\n  };\n\n  return (\n    <div>\n      <div\n        className=\"vm-flex vm-items-center\"\n        onClick={() => setVisible(!visible)}\n      >\n        <div\n          className=\"vm-w-8 vm-h-6 vm-mr-2 vm-border-2 vm-border-white vm-shadow vm-cursor-pointer\"\n          style={{ backgroundColor: colorStr }}\n        />\n        <label className=\"vm-font-semibold\">{setting.label}</label>\n      </div>\n\n      {visible && (\n        <ChromePicker\n          color={colorStr}\n          onChange={handleChange}\n          className=\"vm-mt-2\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default Colorpicker;\n","import * as React from \"react\";\nimport InputNumber from \"rc-input-number\";\nimport \"rc-input-number/assets/index.css\";\n\nimport { ThemeSetting } from \"~/providers/Themes\";\nimport GalleryContext from \"~/context/Gallery\";\n\ntype ControlProps = {\n  setting: ThemeSetting;\n};\n\nconst NumericControl = (props: ControlProps) => {\n  const setting = props.setting;\n  const [value, setValue] = React.useState(parseInt(setting.value));\n  const ctx = React.useContext(GalleryContext);\n\n  const handleChange = (value: number) => {\n    setValue(value);\n    ctx.dispatch({\n      type: `UPDATE_GALLERY_APPEARANCE`,\n      payload: { ...setting, value },\n    });\n  };\n\n  return (\n    <div>\n      <div className=\"vm-font-semibold vm-mb-2\">{setting.label}</div>\n      <InputNumber\n        value={value}\n        defaultValue={setting.value}\n        min={setting.min}\n        max={setting.max}\n        step={setting.step}\n        formatter={(val) => `${val}px`}\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nexport default NumericControl;\n","import * as React from \"react\";\n\nimport { Range } from \"react-range\";\n\nimport GalleryContext from \"~/context/Gallery\";\nimport { ThemeSetting } from \"~/providers/Themes\";\n\ntype ControlProps = {\n  setting: ThemeSetting;\n};\n\nconst SliderControl = (props: ControlProps) => {\n  const setting = props.setting;\n  const [value, setValue] = React.useState(parseInt(setting.value));\n  const ctx = React.useContext(GalleryContext);\n\n  const handleChange = (values: number[]) => {\n    setValue(values[0]);\n    ctx.dispatch({\n      type: `UPDATE_GALLERY_APPEARANCE`,\n      payload: { ...setting, value: values[0] },\n    });\n  };\n\n  return (\n    <div>\n      <div className=\"vm-font-semibold vm-mb-3\">{setting.label}</div>\n\n      <Range\n        step={parseInt(setting.step)}\n        min={parseInt(setting.min)}\n        max={parseInt(setting.max)}\n        values={[parseInt(value)]}\n        onChange={handleChange}\n        renderTrack={({ props, children }) => (\n          <div\n            {...props}\n            style={{\n              ...props.style,\n            }}\n            className=\"vm-w-full vm-h-1 vm-bg-gray-200 vm-rounded-xl\"\n          >\n            {children}\n          </div>\n        )}\n        renderThumb={({ props, isDragged }) => (\n          <div\n            {...props}\n            style={{\n              ...props.style,\n            }}\n            className={`vm-flex vm-items-center vm-justify-center vm-bg-blue-600 vm-rounded-full vm-w-4 vm-h-4`}\n          >\n            <div\n              className={`vm-absolute vm-text-xs vm-px-2 vm-py-1 vm-rounded vm--top-8 vm-text-white vm-bg-blue-600 vm-z-10 ${\n                isDragged ? \"vm-block\" : \"vm-hidden\"\n              }`}\n            >\n              {value}px\n            </div>\n          </div>\n        )}\n      />\n    </div>\n  );\n};\n\nexport default SliderControl;\n","import * as React from \"react\";\nimport Toggle from \"react-toggle\";\nimport \"react-toggle/style.css\"; // for ES6 modules\n\nimport GalleryContext from \"~/context/Gallery\";\nimport { ThemeSetting } from \"~/providers/Themes\";\n\ntype ControlProps = {\n  setting: ThemeSetting;\n};\n\nconst VisibilityControl = (props: ControlProps) => {\n  const setting = props.setting;\n\n  // uses the default value from the theme settings.php file\n  const [checked, setChecked] = React.useState(\n    setting.value === \"block\" ? true : false\n  );\n\n  const ctx = React.useContext(GalleryContext);\n\n  const handleChange = (e) => {\n    const isChecked = e.target.checked;\n    setChecked(isChecked);\n    ctx.dispatch({\n      type: `UPDATE_GALLERY_APPEARANCE`,\n      payload: { ...setting, value: isChecked ? `block` : `none` },\n    });\n  };\n\n  return (\n    <div>\n      <label className=\"vm-flex vm-items-center\">\n        <Toggle checked={checked} onChange={handleChange} />\n        <span className=\"vm-font-semibold vm-mb-2 vm-ml-2 vm-transform vm-translate-y-1\">\n          {setting.label}\n        </span>\n      </label>\n    </div>\n  );\n};\n\nexport default VisibilityControl;\n","import * as React from \"react\";\nimport GalleryContext from \"~/context/Gallery\";\nimport ThemesContext from \"~/context/Themes\";\nimport { Link } from \"react-router-dom\";\n\nimport { Theme } from \"~/providers/Themes\";\n\nimport Colorpicker from \"./Colorpicker\";\nimport NumericControl from \"./Numeric\";\nimport SliderControl from \"./Slider\";\nimport VisibilityControl from \"./Visibility\";\n\nconst AppearanceEditor = () => {\n  const gallery = React.useContext(GalleryContext);\n  const themesCtx = React.useContext(ThemesContext);\n\n  if (themesCtx.isLoading) return <div>Loading…</div>;\n\n  const activeTheme: Theme = themesCtx.state.themes.find(\n    (theme: Theme) => theme.name === gallery.data.theme_name\n  );\n\n  return (\n    <div className=\"vm-overflow-scroll\" style={{ maxHeight: `30rem` }}>\n      <div className=\"vm-py-5 vm-border-b vm-border-gray-200 vm-relative\">\n        <div\n          className=\"vm-absolute vm-inset-0 vm-opacity-90\"\n          style={{\n            background: `linear-gradient(to left, rgb(230, 100, 101), rgb(145 152 229 / 56%)), url(${\n              activeTheme.thumbnail\n            }) no-repeat 100% 100%`,\n          }}\n        />\n        <div className=\"vm-z-10 vm-relative\">\n          <div className=\"vm-flex vm-items-center vm-px-4 vm-py-2\">\n            <div className=\"vm-flex-1\">\n              <div\n                className=\"vm-text-white\"\n                style={{ textShadow: `rgb(28 31 35 / 40%) 0px 2px 2px` }}\n              >\n                Current gallery theme\n              </div>\n\n              <div\n                className=\"vm-font-semibold vm-text-white vm-text-2xl\"\n                style={{ textShadow: `rgb(28 31 35 / 40%) 0px 2px 2px` }}\n              >\n                {activeTheme.name}\n              </div>\n            </div>\n\n            <Link\n              to=\"/appearance/themes\"\n              className=\"vm-bg-white vm-px-2 vm-py-1 vm-rounded vm-text-gray-700 vm-flex vm-items-center vm-text-xs vm-border vm-no-underline\"\n            >\n              <svg\n                className=\"vm-w-4 vm-h-4 vm-mr-1\"\n                fill=\"currentColor\"\n                viewBox=\"0 0 20 20\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <path d=\"M8 5a1 1 0 100 2h5.586l-1.293 1.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L13.586 5H8zM12 15a1 1 0 100-2H6.414l1.293-1.293a1 1 0 10-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L6.414 15H12z\" />\n              </svg>\n              Switch theme…\n            </Link>\n          </div>\n        </div>\n      </div>\n\n      <button\n        className=\"vm-p-4 vm-text-blue-500 vm-flex vm-items-center hover:vm-underline vm-border-0 vm-bg-transparent vm-cursor-pointer\"\n        onClick={() => {\n          gallery.dispatch({ type: `RESET_GALLERY_APPEARANCE` });\n          themesCtx.dispatch({ type: `RESET`, payload: themesCtx.data });\n        }}\n      >\n        <svg\n          className=\"vm-w-4 vm-h-4 vm-mr-1\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\n          />\n        </svg>\n        Reset appearance\n      </button>\n\n      {activeTheme.settings.map((control) => {\n        let Control = null;\n\n        if (control.type === \"colorpicker\") {\n          Control = Colorpicker;\n        } else if (control.type === \"numeric\") {\n          Control = NumericControl;\n        } else if (control.type === \"slider\") {\n          Control = SliderControl;\n        } else if (control.type === \"visibility\") {\n          Control = VisibilityControl;\n        } else {\n          return null;\n        }\n\n        return (\n          <div\n            key={control.id}\n            className=\"vm-px-4 vm-py-5 vm-border-b vm-border-gray-200\"\n          >\n            <Control setting={control} />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default AppearanceEditor;\n","import * as React from \"react\";\nimport { NavLink, Route, Switch } from \"react-router-dom\";\nimport GalleryContext from \"~/context/Gallery\";\n\nconst Setting = ({ children }) => <div className=\"vm-mb-4\">{children}</div>;\n\nconst SettingLabel = ({ children }) => (\n  <label className=\"vm-font-semibold vm-text-gray-700 vm-block vm-mb-1\">\n    {children}\n  </label>\n);\n\nconst BasicSettings = () => {\n  const ctx = React.useContext(GalleryContext);\n\n  const [isRefreshing, setIsRefreshing] = React.useState(false);\n\n  const handleUpdate = (payload) => {\n    ctx.dispatch({\n      type: `EDIT_GALLERY_STATE`,\n      payload,\n    });\n  };\n\n  return (\n    <div className=\"vm-p-4\">\n      <Setting>\n        <SettingLabel>Refresh the videos every</SettingLabel>\n        {/* Specifies how frequently Vimeography should check your Vimeo source for any new videos that may have been added. */}\n\n        <div className=\"vm-flex vm-items-center vm-justify-between\">\n          <select\n            className=\"\"\n            value={ctx.state.cache_timeout}\n            onChange={(e) =>\n              handleUpdate({ cache_timeout: parseInt(e.target.value) })\n            }\n          >\n            <option value=\"0\">page load</option>\n            <option value=\"900\">15 minutes</option>\n            <option value=\"1800\">30 minutes</option>\n            <option value=\"3600\">hour</option>\n            <option value=\"86400\">day</option>\n            <option value=\"604800\">week</option>\n            <option value=\"2419200\">month</option>\n          </select>\n\n          <button\n            className=\"vm-flex vm-items-center vm-text-blue-500 vm-outline-none focus:vm-outline-none vm-border-0 vm-bg-transparent vm-cursor-pointer\"\n            onClick={() => {\n              setIsRefreshing(true);\n              const url =\n                window.location.href +\n                `&vimeography-action=refresh_gallery_cache`;\n              window.location.href = url;\n            }}\n          >\n            <svg\n              className={`vm-w-4 vm-h-4 vm-mr-1 ${\n                isRefreshing ? \"vm-animate-spin\" : \"\"\n              }`}\n              fill=\"currentColor\"\n              viewBox=\"0 0 20 20\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <path\n                fillRule=\"evenodd\"\n                d=\"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n            {isRefreshing ? \"Refreshing…\" : \"Force refresh\"}\n          </button>\n        </div>\n      </Setting>\n      <Setting>\n        <SettingLabel>Number of videos</SettingLabel>\n        <input\n          type=\"number\"\n          min=\"0\"\n          max=\"25\"\n          value={ctx.state.video_limit}\n          onChange={(e) =>\n            handleUpdate({ video_limit: parseInt(e.target.value) })\n          }\n          className=\"vm-mb-2 vm-w-24\"\n        />\n        <p className=\"vm-text-xs vm-text-gray-400\">\n          Specifies the number of videos that will appear in your gallery. Set\n          to 0 for the maximum amount. You can display unlimited videos with{\" \"}\n          <a\n            className=\"vm-text-blue-500\"\n            href=\"https://vimeography.com/pro\"\n            target=\"_blank\"\n          >\n            Vimeography Pro.\n          </a>\n        </p>\n      </Setting>\n      <Setting>\n        <SettingLabel>Max gallery width</SettingLabel>\n        <input\n          type=\"text\"\n          placeholder=\"eg. 960px, 35%\"\n          value={ctx.state.gallery_width}\n          onChange={(e) => handleUpdate({ gallery_width: e.target.value })}\n          className=\"vm-mb-2\"\n        />\n        <p className=\"vm-text-xs vm-text-gray-400\">\n          Specifies the maximum width that your gallery container can expand to.\n        </p>\n      </Setting>\n      <Setting>\n        <SettingLabel>Featured video URL</SettingLabel>\n        <input\n          type=\"text\"\n          placeholder=\"eg. https://vimeo.com/3567483\"\n          value={ctx.state.featured_video}\n          onChange={(e) => handleUpdate({ featured_video: e.target.value })}\n          className=\"vm-mb-2 vm-w-full\"\n        />\n        <p className=\"vm-text-xs vm-text-gray-400\">\n          Sets the specified video as the first video that appears in your\n          gallery.\n        </p>\n      </Setting>\n    </div>\n  );\n};\n\nexport default BasicSettings;\n","import * as React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport GalleryContext from \"~/context/Gallery\";\nimport ThemesContext from \"~/context/Themes\";\n\nconst ThemeList = () => {\n  const gallery = React.useContext(GalleryContext);\n  const themes = React.useContext(ThemesContext);\n\n  const formRef = React.useRef();\n  const themeFieldRef = React.useRef();\n\n  const handleClick = (themeName) => {\n    themeFieldRef.current.value = themeName;\n    formRef.current.submit();\n  };\n\n  return (\n    <div>\n      <Link\n        to=\"/appearance\"\n        className=\"vm-text-blue-500 vm-p-4 vm-flex vm-items-center vm-no-underline\"\n      >\n        <svg\n          className=\"vm-w-4 vm-h-4 vm-mr-1\"\n          fill=\"currentColor\"\n          viewBox=\"0 0 20 20\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n        Back to appearance editor\n      </Link>\n      <form ref={formRef} method=\"post\" action=\"\">\n        <input\n          type=\"hidden\"\n          name=\"vimeography-theme-verification\"\n          value={window.vimeographyThemeNonce}\n        />\n        <input type=\"hidden\" name=\"theme_name\" value=\"\" ref={themeFieldRef} />\n        <input\n          type=\"hidden\"\n          name=\"vimeography-action\"\n          value=\"set_gallery_theme\"\n        />\n      </form>\n      <div className=\"vm-max-h-96 vm-overflow-scroll\">\n        {themes.data.map((theme) => {\n          const isActiveTheme =\n            theme.name.toLowerCase() === gallery.data.theme_name.toLowerCase();\n\n          return (\n            <div\n              key={theme.name}\n              onClick={() => handleClick(theme.name)}\n              className={`vm-group vm-flex vm-items-center vm-px-4 vm-py-2 vm-cursor-pointer vm-border-b vm-transition ${\n                isActiveTheme ? \"vm-bg-indigo-500\" : \"hover:vm-bg-indigo-600\"\n              }`}\n            >\n              <img\n                src={theme.thumbnail}\n                className=\"vm-w-10 vm-mr-3 vm-rounded vm-shadow\"\n              />\n              <div>\n                <span\n                  className={`vm-font-semibold vm-block vm-text-sm group-hover:vm-text-white ${\n                    isActiveTheme ? \"vm-text-white\" : \"vm-text-gray-700\"\n                  }`}\n                >\n                  {theme.name}\n                </span>\n                <span\n                  className={`vm-text-xs group-hover:vm-text-gray-50 ${\n                    isActiveTheme ? \"vm-text-gray-50\" : \"vm-text-gray-400\"\n                  }`}\n                >\n                  v{theme.version}\n                </span>\n                {!isActiveTheme && (\n                  <span\n                    className={`vm-text-xs vm-opacity-0 group-hover:vm-opacity-100 group-hover:vm-text-gray-50 \"vm-text-gray-400\"\n                    }`}\n                  >\n                    {\" \"}\n                    • Switch to {theme.name}\n                  </span>\n                )}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default ThemeList;\n","import * as React from \"react\";\n\nconst ProSellPanel = () => {\n  return (\n    <div className=\"vm-p-5\">\n      <h2 className=\"vm-text-xl vm-font-bold vm-text-gray-700 vm-mb-4\">\n        Add the features your viewers are asking for.\n      </h2>\n\n      <ul className=\"vm-mb-6\">\n        <li className=\"vm-flex vm-items-center vm-mb-2\">\n          <svg\n            className=\"vm-w-5 vm-h-5 vm-text-blue-500 vm-mr-2\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path d=\"M4.555 5.168A1 1 0 003 6v8a1 1 0 001.555.832L10 11.202V14a1 1 0 001.555.832l6-4a1 1 0 000-1.664l-6-4A1 1 0 0010 6v2.798l-5.445-3.63z\" />\n          </svg>\n          <span className=\"vm-text-gray-600\">Unlimited videos</span>\n        </li>\n        <li className=\"vm-flex vm-items-center vm-mb-2\">\n          <svg\n            className=\"vm-w-5 vm-h-5 vm-text-yellow-500 vm-mr-2\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path d=\"M9 9a2 2 0 114 0 2 2 0 01-4 0z\" />\n            <path\n              fillRule=\"evenodd\"\n              d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n          Searchable galleries\n        </li>\n        <li className=\"vm-flex vm-items-center vm-mb-2\">\n          <svg\n            className=\"vm-w-5 vm-h-5 vm-text-indigo-500 vm-mr-2\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path d=\"M5.5 16a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 16h-8z\" />\n          </svg>\n          Downloadable videos\n        </li>\n        <li className=\"vm-flex vm-items-center vm-mb-2\">\n          <svg\n            className=\"vm-w-5 vm-h-5 vm-text-green-500 vm-mr-2\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path d=\"M8 5a1 1 0 100 2h5.586l-1.293 1.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L13.586 5H8zM12 15a1 1 0 100-2H6.414l1.293-1.293a1 1 0 10-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L6.414 15H12z\" />\n          </svg>\n          Simple sorting\n        </li>\n        <li className=\"vm-flex vm-items-center vm-mb-2\">\n          <svg\n            className=\"vm-w-5 vm-h-5 vm-text-pink-500 vm-mr-2\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n          Show protected videos\n        </li>\n        <li className=\"vm-flex vm-items-center vm-mb-2\">\n          <svg\n            className=\"vm-w-5 vm-h-5 vm-text-red-500 vm-mr-2\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n          No code required\n        </li>\n      </ul>\n\n      <a\n        href=\"https://vimeography.com/pro\"\n        target=\"_blank\"\n        className=\"vm-box-border vm-px-4 vm-py-3 vm-rounded vm-border vm-shadow-sm vm-mx-auto vm-text-base vm-bg-white vm-text-indigo-800 vm-text-center vm-mb-2 vm-inline-flex vm-items-center vm-justify-center vm-w-full\"\n      >\n        <svg\n          className=\"vm-w-5 vm-h-5 vm-mr-1\"\n          fill=\"currentColor\"\n          viewBox=\"0 0 20 20\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n        Watch the video\n      </a>\n      <p className=\"vm-text-xs vm-text-gray-500 vm-text-center\">\n        Over 5,000 happy customers!\n      </p>\n    </div>\n  );\n};\n\nexport default ProSellPanel;\n","import * as React from \"react\";\nimport { NavLink, Route, Switch, useRouteMatch } from \"react-router-dom\";\nimport GalleryContext from \"~/context/Gallery\";\nimport { useNotification } from \"~/hooks/useNotification\";\nimport AppearanceEditor from \"./AppearanceEditor/AppearanceEditor\";\nimport BasicSettings from \"./BasicSettings/BasicSettings\";\nimport ThemeList from \"./ThemeList/ThemeList\";\nimport { motion } from \"framer-motion\";\n\nimport { ErrorBoundary } from \"react-error-boundary\";\nconst ProSettings = React.lazy(() => import(\"vimeography_pro/ProSettings\"));\nimport ProSellPanel from \"./ProSellPanel\";\n\nconst NavItem = (props) => (\n  <NavLink\n    to={props.to}\n    exact\n    className=\"vm-bg-gray-50 vm-border-b vm-no-underline vm-flex vm-items-center vm-px-4 vm-py-3 vm-text-gray-700 vm-outline-none hover:no-underline focus:vm-outline-none focus:vm-no-underline vm-font-semibold\"\n    activeClassName=\"vm-bg-white vm-border-l-4 vm-border-indigo-700 vm-outline-none focus:vm-outline-none focus:vm-no-underline\"\n  >\n    {props.children}\n  </NavLink>\n);\n\nconst Menu = () => {\n  const variants = {\n    open: { height: \"auto\", opacity: 1 },\n    closed: { height: \"0\", opacity: 0 },\n  };\n\n  const isSettingsPanel = useRouteMatch({ path: \"/\", strict: true });\n  const isAppearancePanel = useRouteMatch({\n    path: \"/appearance\",\n    strict: true,\n  });\n\n  const galleryCtx = React.useContext(GalleryContext);\n  const isProPanel = useRouteMatch({ path: \"/pro\", strict: true });\n\n  return (\n    <>\n      <NavItem to=\"/\">\n        <svg\n          className=\"vm-w-5 vm-h-5 vm-mr-2 vm-text-blue-600\"\n          fill=\"currentColor\"\n          viewBox=\"0 0 20 20\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n        <span>Settings</span>\n      </NavItem>\n\n      <motion.div\n        className=\"vm-overflow-hidden\"\n        animate={isSettingsPanel.isExact ? \"open\" : \"closed\"}\n        variants={variants}\n        transition={{ duration: 0.25, ease: \"easeOut\", bounce: 0 }}\n      >\n        <BasicSettings />\n      </motion.div>\n\n      <NavItem to=\"/appearance\">\n        <svg\n          className=\"vm-w-5 vm-h-5 vm-mr-2 vm-text-green-600\"\n          fill=\"currentColor\"\n          viewBox=\"0 0 20 20\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n        <span>Appearance</span>\n      </NavItem>\n      <motion.div\n        className=\"vm-overflow-hidden\"\n        animate={isAppearancePanel ? \"open\" : \"closed\"}\n        variants={variants}\n        transition={{ duration: 0.25, ease: \"easeOut\", bounce: 0 }}\n      >\n        <Switch>\n          <Route path=\"/appearance/themes\">\n            <ThemeList />\n          </Route>\n          <Route path=\"/appearance\" strict>\n            <AppearanceEditor />\n          </Route>\n        </Switch>\n      </motion.div>\n      <NavItem to=\"/pro\">\n        <svg\n          className=\"vm-w-5 vm-h-5 vm-mr-2 vm-text-yellow-600\"\n          fill=\"currentColor\"\n          viewBox=\"0 0 20 20\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732l-3.354 1.935-1.18 4.455a1 1 0 01-1.933 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732l3.354-1.935 1.18-4.455A1 1 0 0112 2z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n        <span>Vimeography Pro</span>\n      </NavItem>\n      <motion.div\n        className=\"vm-overflow-hidden\"\n        animate={isProPanel ? \"open\" : \"closed\"}\n        variants={variants}\n        transition={{ duration: 0.25, ease: \"easeOut\", bounce: 0 }}\n      >\n        <ErrorBoundary FallbackComponent={ProSellPanel}>\n          <React.Suspense fallback={<p>Loading Vimeography Pro…</p>}>\n            <ProSettings isProPanel={isProPanel} galleryCtx={galleryCtx} />\n          </React.Suspense>\n        </ErrorBoundary>\n      </motion.div>\n    </>\n  );\n};\n\nconst Skeleton = () => {\n  const [phrase, set] = React.useState(`Loading…`);\n\n  React.useEffect(() => {\n    const cb = () => {\n      const phrases = [\n        `Be right there…`,\n        `Churning the butter…`,\n        `Petting cute doggies…`,\n        `Checking the fridge again…`,\n        `Flossing…`,\n        `Loading…`,\n        `Waiting in line…`,\n        `On my way…`,\n        `Ready in a sec…`,\n        `Coming in for landing…`,\n        `Adding final touches…`,\n        `Quick restroom visit…`,\n        `Pouring coffee…`,\n        `Traffic on 77N…`,\n        `Stuck behind a slow walker…`,\n        `Waiting for rain to stop…`,\n        `Going as fast as I can…`,\n        `Almost got it…`,\n      ];\n      const phrase = phrases[Math.floor(Math.random() * phrases.length)];\n      set(phrase);\n    };\n\n    const task = setInterval(cb, 2000);\n\n    return () => {\n      clearInterval(task);\n    };\n  }, []);\n\n  return (\n    <div\n      className=\"vm-bg-gray-200 vm-animate-pulse vm-w-full vm-flex vm-flex-col vm-items-center vm-justify-center vm-rounded vm-border vm-border-gray-200 vm-mt-5 vm-sticky vm-top-10 vm-text-indigo-600\"\n      style={{\n        height: `30rem`,\n        backgroundImage: `linear-gradient(16deg, rgba(116, 116, 116,0.02) 0%, rgba(116, 116, 116,0.02) 25%,transparent 25%, transparent 96%,rgba(177, 177, 177,0.02) 96%, rgba(177, 177, 177,0.02) 100%),linear-gradient(236deg, rgba(148, 148, 148,0.02) 0%, rgba(148, 148, 148,0.02) 53%,transparent 53%, transparent 59%,rgba(56, 56, 56,0.02) 59%, rgba(56, 56, 56,0.02) 100%),linear-gradient(284deg, rgba(16, 16, 16,0.02) 0%, rgba(16, 16, 16,0.02) 46%,transparent 46%, transparent 71%,rgba(181, 181, 181,0.02) 71%, rgba(181, 181, 181,0.02) 100%),linear-gradient(316deg, rgba(197, 197, 197,0.02) 0%, rgba(197, 197, 197,0.02) 26%,transparent 26%, transparent 49%,rgba(58, 58, 58,0.02) 49%, rgba(58, 58, 58,0.02) 100%),linear-gradient(90deg, rgb(255,255,255),rgb(255,255,255))`,\n      }}\n    >\n      <svg\n        className=\"vm-w-6 vm-h-6 vm-animate-spin vm-text-indigo-800 vm-mb-2\"\n        fill=\"currentColor\"\n        viewBox=\"0 0 20 20\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          fillRule=\"evenodd\"\n          d=\"M9.504 1.132a1 1 0 01.992 0l1.75 1a1 1 0 11-.992 1.736L10 3.152l-1.254.716a1 1 0 11-.992-1.736l1.75-1zM5.618 4.504a1 1 0 01-.372 1.364L5.016 6l.23.132a1 1 0 11-.992 1.736L4 7.723V8a1 1 0 01-2 0V6a.996.996 0 01.52-.878l1.734-.99a1 1 0 011.364.372zm8.764 0a1 1 0 011.364-.372l1.733.99A1.002 1.002 0 0118 6v2a1 1 0 11-2 0v-.277l-.254.145a1 1 0 11-.992-1.736l.23-.132-.23-.132a1 1 0 01-.372-1.364zm-7 4a1 1 0 011.364-.372L10 8.848l1.254-.716a1 1 0 11.992 1.736L11 10.58V12a1 1 0 11-2 0v-1.42l-1.246-.712a1 1 0 01-.372-1.364zM3 11a1 1 0 011 1v1.42l1.246.712a1 1 0 11-.992 1.736l-1.75-1A1 1 0 012 14v-2a1 1 0 011-1zm14 0a1 1 0 011 1v2a1 1 0 01-.504.868l-1.75 1a1 1 0 11-.992-1.736L16 13.42V12a1 1 0 011-1zm-9.618 5.504a1 1 0 011.364-.372l.254.145V16a1 1 0 112 0v.277l.254-.145a1 1 0 11.992 1.736l-1.735.992a.995.995 0 01-1.022 0l-1.735-.992a1 1 0 01-.372-1.364z\"\n          clipRule=\"evenodd\"\n        />\n      </svg>\n      <div className=\"vm-text-xs\">{phrase}</div>\n    </div>\n  );\n};\n\nconst GalleryEditorHeading = () => {\n  const ctx = React.useContext(GalleryContext);\n  const [isEditing, setIsEditing] = React.useState(false);\n  const handleUpdate = (payload) => {\n    ctx.dispatch({\n      type: `EDIT_GALLERY_STATE`,\n      payload,\n    });\n  };\n\n  return (\n    <div className=\"vm-p-4 vm-bg-indigo-700 vm-rounded-t vm-flex\">\n      <div className=\"vm-flex-1\">\n        {isEditing ? (\n          <div className=\"vm-pr-4\">\n            <label className=\"vm-text-white vm-font-semibold vm-block vm-mb-1\">Gallery title</label>\n            <input\n              type=\"text\"\n              placeholder=\"eg. 960px, 35%\"\n              value={ctx.state.title}\n              onChange={(e) => handleUpdate({ title: e.target.value })}\n              className=\"vm-mb-4 vm-w-full\"\n            />\n            <label className=\"vm-text-white vm-font-semibold vm-block vm-mb-1\">Vimeo collection URL</label>\n            <input\n              type=\"text\"\n              placeholder=\"eg. 960px, 35%\"\n              value={ctx.state.source_url}\n              onChange={(e) => handleUpdate({ source_url: e.target.value })}\n              className=\"vm-mb-2 vm-w-full\"\n            />\n          </div>\n        ) : (\n          <>\n            <h2 className=\"vm-text-lg vm-text-white vm-font-bold vm-my-0\">\n              {ctx.state.title}\n            </h2>\n            <a href={ctx.state.source_url} className=\"vm-text-indigo-50 vm-text-sm\">\n              {ctx.state.source_url}\n            </a>\n          </>\n        )}\n      </div>\n      <div className=\"vm-cursor-pointer\" onClick={() => setIsEditing(!isEditing)}>\n        {isEditing ? (\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"vm-text-white vm-h-5 vm-w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n          </svg>\n        ) : (\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"vm-text-white vm-h-5 vm-w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n          </svg>\n        )}\n      </div>\n    </div>\n  )\n}\n\nconst GalleryEditor = () => {\n  const ctx = React.useContext(GalleryContext);\n  const [submitting, setSubmitting] = React.useState(false);\n  const { showNotification } = useNotification();\n\n  const handleSubmit = async () => {\n    setSubmitting(true);\n\n    try {\n      const {\n        id,\n        resource_uri,\n        date_created,\n        appearanceRules,\n        ...payload\n      } = ctx.state;\n\n      const styles = document.getElementById(\n        `vimeography-gallery-${ctx.data.id}-custom-css-preview`\n      ).innerText;\n      console.log({ styles });\n\n      const responseA = await fetch(\n        window.vimeographyApiSettings.root +\n        `vimeography/v1/galleries/${ctx.data.id}/appearance`,\n        {\n          method: \"POST\",\n          mode: \"same-origin\",\n          cache: \"no-cache\",\n          credentials: \"same-origin\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"X-WP-Nonce\": window.wpApiSettings\n              ? window.wpApiSettings.nonce\n              : window.vimeographyApiSettings.nonce,\n            // 'Content-Type': 'application/x-www-form-urlencoded',\n          },\n          body: JSON.stringify({ css: styles }), // body data type must match \"Content-Type\" header\n        }\n      );\n\n      console.log(`styles saved: ${responseA.ok}`);\n\n      const response = await fetch(\n        window.vimeographyApiSettings.root +\n        `vimeography/v1/galleries/${ctx.data.id}`,\n        {\n          method: \"PATCH\",\n          mode: \"same-origin\",\n          cache: \"no-cache\",\n          credentials: \"same-origin\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"X-WP-Nonce\": window.wpApiSettings\n              ? window.wpApiSettings.nonce\n              : window.vimeographyApiSettings.nonce,\n            // 'Content-Type': 'application/x-www-form-urlencoded',\n          },\n          body: JSON.stringify(payload), // body data type must match \"Content-Type\" header\n        }\n      );\n\n      await response.json();\n      showNotification(`success`, \"Saved! Reloading gallery…\");\n    } catch (error) {\n      console.log(error);\n      showNotification(`error`, \"Whoops! We hit a snag saving your settings.\");\n    } finally {\n      // setSubmitting(false);\n      location.reload();\n    }\n  };\n\n  if (ctx.isLoading) return <Skeleton />;\n\n  return (\n    <div className=\"vm-bg-gray-100 vm-rounded vm-border vm-border-gray-200 vm-mt-5 vm-sticky vm-top-10\">\n      <GalleryEditorHeading />\n\n      <Menu />\n      <div className=\"vm-flex vm-justify-end\">\n        <button\n          className=\"vm-bg-blue-600 hover:vm-bg-blue-700 vm-m-4 vm-text-white vm-px-3 vm-py-2 vm-rounded vm-border-0 vm-cursor-pointer\"\n          onClick={handleSubmit}\n          disabled={submitting}\n        >\n          {submitting ? \"Saving…\" : \"Save changes\"}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default GalleryEditor;\n","import * as React from \"react\";\nimport NotificationContext from \"../context/Notification\";\n\nexport function useNotification() {\n  const notificationHelpers = React.useContext(NotificationContext);\n  return notificationHelpers;\n}\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { useMutation, useQueryClient } from \"react-query\";\n\nimport { Gallery } from \"./ListGalleries\";\n\ntype DuplicateGalleryProps = {\n  gallery: Gallery;\n  setDuplicateGalleryModalOpen: (toggle: boolean) => void;\n};\n\ntype DuplicateGalleryPayload = {\n  gallery_id: string;\n  title: string;\n  source: string;\n  copyAppearance: boolean;\n};\n\nconst DuplicateGallery = (props: DuplicateGalleryProps) => {\n  const [title, setTitle] = React.useState(`${props.gallery.title} copy`);\n  const [source, setSource] = React.useState(props.gallery.source_url);\n  const [copyAppearance, setCopyAppearance] = React.useState(true);\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation(\n    (payload: DuplicateGalleryPayload) =>\n      fetch(\n        (window as any).vimeographyApiSettings.root +\n          `vimeography/v1/galleries/${payload.gallery_id}/duplicate`,\n        {\n          method: \"POST\",\n          mode: \"same-origin\",\n          cache: \"no-cache\",\n          credentials: \"same-origin\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"X-WP-Nonce\": window.wpApiSettings\n              ? window.wpApiSettings.nonce\n              : window.vimeographyApiSettings.nonce,\n          },\n          body: JSON.stringify({\n            id: payload.gallery_id,\n            title: payload.title,\n            source_url: payload.source,\n            copy_appearance: payload.copyAppearance,\n          }), // body data type must match \"Content-Type\" header\n        }\n      ),\n    {\n      onSuccess: () => {\n        queryClient.invalidateQueries(\"galleries\");\n      },\n    }\n  );\n\n  const handle = async () => {\n    // make request, close modal, reload galleries\n    try {\n      const result = await mutation.mutate({\n        gallery_id: props.gallery.id,\n        title,\n        source,\n        copyAppearance,\n      });\n\n      await props.setDuplicateGalleryModalOpen(false);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return ReactDOM.createPortal(\n    <div className=\"vm-inset-0 vm-fixed vm-flex vm-items-center vm-justify-center vm-bg-gray-700 vm-bg-opacity-70\">\n      <div className=\"vm-bg-gray-100 vm-rounded vm-p-10 vm-shadow vm-w-full vm-relative vm-max-w-lg\">\n        <div\n          className=\"vm-text-3xl vm-stroke-current vm-text-white vm-cursor-pointer vm-absolute vm-right-0\"\n          style={{ transform: \"translate(5px, -70px)\" }}\n          onClick={() => props.setDuplicateGalleryModalOpen(false)}\n        >\n          <svg\n            className=\"vm-w-6 vm-h-6\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n        </div>\n\n        <h2 className=\"vm-text-xl vm-mb-5 vm-font-semibold\">\n          Duplicate gallery\n        </h2>\n\n        <form method=\"get\" action=\"\">\n          <div className=\"vm-mb-4\">\n            <label className=\"vm-text-sm vm-block vm-mb-1 vm-font-semibold\">\n              New Gallery Title\n            </label>\n            <input\n              type=\"text\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              className=\"vm-w-72\"\n            />\n          </div>\n\n          <div className=\"vm-mb-5\">\n            <label className=\"vm-text-sm vm-block vm-mb-1 vm-font-semibold\">\n              Show the videos from\n            </label>\n            <input\n              type=\"text\"\n              value={source}\n              onChange={(e) => setSource(e.target.value)}\n              className=\"vm-w-72\"\n            />\n          </div>\n\n          <div className=\"vm-mb-8\">\n            <label className=\"vm-flex vm-items-center\">\n              <input\n                type=\"checkbox\"\n                checked={copyAppearance}\n                onChange={(e) => setCopyAppearance(e.target.checked)}\n              />{\" \"}\n              <span className=\"vm-ml-1\">\n                Also copy gallery appearance settings\n              </span>\n            </label>\n          </div>\n\n          <button\n            onClick={handle}\n            className=\"vm-bg-blue-500 vm-text-white vm-px-3 vm-py-2 vm-rounded hover:vm-bg-blue-700\"\n            disabled={mutation.isLoading}\n          >\n            {mutation.isLoading ? \"Duplicating…\" : \"Duplicate gallery\"}\n          </button>\n        </form>\n      </div>\n    </div>,\n    document.body\n  );\n};\n\nexport default DuplicateGallery;\n","import * as React from \"react\";\nimport { useMutation, useQueryClient } from \"react-query\";\n\nimport { Gallery } from \"./ListGalleries\";\n\ntype GalleryRowProps = {\n  gallery: Gallery;\n  setGalleryToDuplicate: (id: string) => void;\n  setDuplicateGalleryModalOpen: (toggle: boolean) => void;\n};\n\nconst GalleryRow = (props: GalleryRowProps) => {\n  const gallery = props.gallery;\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation(\n    (id: string) =>\n      fetch(\n        (window as any).vimeographyApiSettings.root +\n          `vimeography/v1/galleries/${id}`,\n        {\n          method: \"DELETE\",\n          mode: \"same-origin\",\n          cache: \"no-cache\",\n          credentials: \"same-origin\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"X-WP-Nonce\": window.wpApiSettings\n              ? window.wpApiSettings.nonce\n              : window.vimeographyApiSettings.nonce,\n          },\n        }\n      ),\n    {\n      onSuccess: () => {\n        queryClient.invalidateQueries(\"galleries\");\n      },\n    }\n  );\n\n  const handleDelete = async (id: string) => {\n    if (\n      !confirm(\n        \"WARNING: You are about to delete this gallery. 'Cancel' to stop, 'OK' to delete.\"\n      )\n    ) {\n      return false;\n    }\n\n    try {\n      await mutation.mutate(id);\n    } catch (error) {}\n  };\n\n  return (\n    <tr\n      className=\"vm-text-sm vm-text-gray-700 odd:vm-bg-gray-50\"\n      key={gallery.id}\n    >\n      <td className=\"vm-p-4\">{gallery.id}</td>\n      <td>\n        <strong>\n          <a\n            className=\"vm-no-underline vm-text-gray-600\"\n            href={`?page=vimeography-edit-galleries&id=${gallery.id}`}\n          >\n            {gallery.title}\n          </a>\n        </strong>\n      </td>\n      <td className=\"vm-p-4\">\n        <a\n          className=\"vm-text-blue-500\"\n          href={gallery.source_url}\n          target=\"_blank\"\n        >\n          {gallery.source_url}\n        </a>\n      </td>\n      <td className=\"vm-p-4 vm-font-mono\">[vimeography id=\"{gallery.id}\"]</td>\n      <td className=\"vm-p-4\">{gallery.theme_name}</td>\n      <td className=\"vm-p-4\">{gallery.date_created}</td>\n      <td className=\"vm-p-4\">\n        <div className=\"vm-flex vm-items-center\">\n          <a\n            href={`?page=vimeography-edit-galleries&id=${gallery.id}`}\n            title=\"Edit Gallery\"\n            className=\"vm-cursor-pointer\"\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"#ad915e\"\n              className=\"vm-w-6 vm-h-6 vm-mx-2\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"2\"\n                d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"\n              />\n            </svg>\n          </a>\n\n          <a\n            href=\"#\"\n    title=\"Duplicate Gallery\"\n            className=\"vm-cursor-pointer\"\n            onClick={(e) => {\n              e.preventDefault();\n              props.setGalleryToDuplicate(gallery.id);\n              props.setDuplicateGalleryModalOpen(true);\n            }}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"#4d60bf\"\n              className=\"vm-w-6 vm-h-6 vm-mx-2\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"2\"\n                d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\"\n              />\n            </svg>\n          </a>\n\n          <a\n            className=\"vm-cursor-pointer\"\n            title=\"Delete Gallery\"\n            onClick={() => handleDelete(gallery.id)}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"#B73657\"\n              className=\"vm-w-6 vm-h-6 vm-mx-2\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"2\"\n                d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\n              />\n            </svg>\n          </a>\n        </div>\n      </td>\n    </tr>\n  );\n};\n\nexport default GalleryRow;\n","import * as React from \"react\";\nimport { NavLink } from \"react-router-dom\";\n\ntype MenuItemProps = {\n  to: string;\n  children: any;\n};\n\nconst MenuItem = (props: MenuItemProps) => {\n  return (\n    <NavLink\n      className=\"vm-mr-6 vm-border-solid vm-border-0 vm-py-2 vm-text-base focus:vm-outline-none vm-font-semibold vm-text-gray-600 vm-no-underline\"\n      activeClassName=\"vm-border-b-4 vm-border-indigo-500\"\n      to={props.to}\n      exact={props.to === \"/\"}\n    >\n      {props.children}\n    </NavLink>\n  );\n};\n\nconst ListGalleriesMenu = () => {\n  return (\n    <div className=\"vm-my-8\">\n      <MenuItem to=\"/\">Galleries</MenuItem>\n      <MenuItem to=\"/tools\">Tools</MenuItem>\n      {/* <MenuItem to=\"/filters\">Filters</MenuItem> */}\n    </div>\n  );\n};\n\nexport default ListGalleriesMenu;\n","import * as React from \"react\";\nimport { useQuery } from \"react-query\";\n\nimport { Route, Switch } from \"react-router-dom\";\n\nimport DuplicateGallery from \"./DuplicateGallery\";\nimport GalleryRow from \"./GalleryRow\";\nimport Menu from \"./Menu\";\n\n// Pro tools\nimport { ErrorBoundary } from \"react-error-boundary\";\nconst ProTools = React.lazy(() => import(\"vimeography_pro/ProTools\"));\n// const Filters = React.lazy(() => import(\"vimeography_pro/Filters\"));\n\nexport type Gallery = {\n  id: string;\n  source_url: string;\n  theme_name: string;\n  title: string;\n  date_created: string;\n};\n\nconst NoGalleries = () => {\n  return (\n    <h1>\n      You don't have any galleries.{\" \"}\n      <a\n        className=\"vm-text-blue-500\"\n        href={`?page=vimeography-new-gallery`}\n        title=\"Create a new gallery\"\n      >\n        Care to make one?\n      </a>\n    </h1>\n  );\n};\n\nconst ProToolsAd = () => {\n  return (\n    <div>\n      <h2 className=\"vm-text-lg vm-text-gray-700\">\n        Back up all of your galleries with Vimeography Pro.\n      </h2>\n      <a\n        href=\"https://vimeography.com/pro\"\n        className=\"vm-text-blue-500 vm-text-base\"\n        target=\"_blank\"\n      >\n        Learn more\n      </a>\n    </div>\n  );\n};\n\n// const FiltersAd = () => {\n//   return <div>Coming soon…</div>;\n// };\n\nconst ListGalleries = () => {\n  const [\n    duplicateGalleryModalOpen,\n    setDuplicateGalleryModalOpen,\n  ] = React.useState(false);\n\n  const [galleryToDuplicate, setGalleryToDuplicate] = React.useState(null);\n\n  const { isLoading, error, data } = useQuery([`galleries`], () => {\n    return fetch(\n      (window as any).vimeographyApiSettings.root + `vimeography/v1/galleries`\n    ).then((res) => {\n      return res.json();\n    });\n  });\n\n  if (isLoading)\n    return (\n      <div className=\"vm-bg-gray-200 vm-w-full vm-h-32 vm-my-10 vm-animate-pulse vm-flex vm-items-center vm-justify-center vm-rounded vm-text-gray-700\">\n        Loading galleries…\n      </div>\n    );\n\n  return (\n    <>\n      {duplicateGalleryModalOpen && (\n        <DuplicateGallery\n          gallery={data.find(\n            (gallery: Gallery) => gallery.id === galleryToDuplicate\n          )}\n          setDuplicateGalleryModalOpen={setDuplicateGalleryModalOpen}\n        />\n      )}\n\n      <Menu />\n\n      <div className=\"vm-container\">\n        {data.length === 0 ? (\n          <NoGalleries />\n        ) : (\n          <Switch>\n            <Route path=\"/\" exact>\n              <table className=\"vm-my-4 vm-w-full vm-border vm-shadow-xl\">\n                <thead>\n                  <tr>\n                    <th className=\"vm-px-4 vm-py-4 vm-text-left\">ID</th>\n                    <th className=\"vm-px-4 vm-py-4 vm-text-left\">Title</th>\n                    <th className=\"vm-px-4 vm-py-4 vm-text-left\">\n                      Video Source\n                    </th>\n                    <th className=\"vm-px-4 vm-py-4 vm-text-left\">Shortcode</th>\n                    <th className=\"vm-px-4 vm-py-4 vm-text-left\">\n                      Gallery Theme\n                    </th>\n                    <th className=\"vm-px-4 vm-py-4 vm-text-left\">Created on</th>\n                    <th className=\"vm-px-4 vm-py-4 vm-text-left\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {data.map((gallery: Gallery) => {\n                    return (\n                      <GalleryRow\n                        key={gallery.id}\n                        gallery={gallery}\n                        setDuplicateGalleryModalOpen={\n                          setDuplicateGalleryModalOpen\n                        }\n                        setGalleryToDuplicate={setGalleryToDuplicate}\n                      />\n                    );\n                  })}\n                </tbody>\n              </table>\n            </Route>\n\n            <Route path=\"/tools\" exact>\n              <ErrorBoundary FallbackComponent={ProToolsAd}>\n                <React.Suspense fallback={<div />}>\n                  <ProTools />\n                </React.Suspense>\n              </ErrorBoundary>\n            </Route>\n\n            {/* <Route path=\"/filters\">\n              <ErrorBoundary FallbackComponent={FiltersAd}>\n                <React.Suspense fallback={<div />}>\n                  <Filters />\n                </React.Suspense>\n              </ErrorBoundary>\n            </Route> */}\n          </Switch>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default ListGalleries;\n","import * as React from \"react\";\nimport URLSearchParams from \"@ungap/url-search-params\";\nimport { MemoryRouter as Router, Switch, Route } from \"react-router-dom\";\n\nimport { QueryClient, QueryClientProvider } from \"react-query\";\nconst queryClient = new QueryClient();\n\nimport ThemesProvider from \"../providers/Themes\";\nimport GalleryProvider from \"../providers/Gallery\";\nimport NotificationProvider from \"../providers/Notification\";\nimport GalleryEditor from \"../components/GalleryEditor/GalleryEditor\";\n\nimport ListGalleries from \"../pages/ListGalleries/ListGalleries\";\n\nconst App = () => {\n  const params = new URLSearchParams(document.location.search.substring(1));\n\n  const id = params.get(`id`);\n  const page = params.get(`page`);\n\n  // Need to fake a top-level router here since\n  // these subcomponents implement a MemoryRouter\n  const isListGalleries = page === `vimeography-edit-galleries` && id === null;\n  const isEditGallery = page === `vimeography-edit-galleries` && id !== null;\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <NotificationProvider>\n        <ThemesProvider>\n          <Router>\n            {isListGalleries && <ListGalleries />}\n\n            {isEditGallery && (\n              <GalleryProvider id={id}>\n                <GalleryEditor />\n              </GalleryProvider>\n            )}\n          </Router>\n        </ThemesProvider>\n      </NotificationProvider>\n    </QueryClientProvider>\n  );\n};\n\nexport default App;\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport \"tailwindcss/tailwind.css\";\n\nimport App from \"./containers/App\";\nReactDOM.render(<App />, document.getElementById(\"vimeography_admin_app\"));\n","import * as React from \"react\";\nimport { GalleryState } from \"../providers/Gallery\";\n\ntype GalleryContext = {\n  isLoading: boolean;\n  error: Error;\n  data: GalleryState;\n  state: GalleryState;\n  dispatch: any;\n};\n\nconst ctx: GalleryContext = {\n  isLoading: true,\n  error: null,\n  data: null,\n  state: null,\n  dispatch: () => {},\n};\n\nconst GalleryContext = React.createContext(ctx);\n\nexport default GalleryContext;\n","import * as React from \"react\";\nimport { ThemesState } from \"../providers/Themes\";\n\ntype ThemesContext = {\n  isLoading: boolean;\n  error: Error;\n  data: ThemesState;\n  state: ThemesState;\n  dispatch: any;\n};\n\nconst ctx: ThemesContext = {\n  isLoading: true,\n  error: null,\n  data: null,\n  state: null,\n  dispatch: () => {},\n};\n\nconst ThemesContext = React.createContext(ctx);\n\nexport default ThemesContext;\n","import * as React from \"react\";\nimport GalleryContext from \"../context/Gallery\";\nimport { useQuery } from \"react-query\";\nimport produce from \"immer\";\nimport { Helmet } from \"react-helmet\";\nimport { useDebouncedCallback } from \"use-debounce\";\n\nimport { Theme, ThemeSetting, ThemeSettingType } from \"~/providers/Themes\";\nimport ThemesContext from \"../context/Themes\";\n\ntype GalleryProviderProps = React.PropsWithChildren<{ id?: string }>;\n\nexport type GalleryState = {\n  id?: number;\n  cache_timeout?: number;\n  date_created?: string;\n  featured_video?: string;\n  gallery_width?: string;\n  resource_uri?: string;\n  source_url?: string;\n  theme_name?: string;\n  title?: string;\n  video_limit?: number;\n  appearanceRules?: GalleryAppearanceRule[];\n  allow_downloads?: boolean;\n  sort?: SortType;\n  direction?: SortDirection;\n  enable_search?: boolean;\n  enable_tags?: boolean;\n  enable_playlist?: boolean;\n  per_page?: number;\n};\n\ntype SortDirection = \"asc\" | \"desc\";\ntype SortType =\n  | \"date\"\n  | \"likes\"\n  | \"comments\"\n  | \"plays\"\n  | \"alphabetical\"\n  | \"duration\"\n  | \"default\";\ninterface GalleryResponse {\n  id: number;\n  cache_timeout: number;\n  date_created: string;\n  featured_video: string;\n  gallery_width: string;\n  resource_uri: string;\n  source_url: string;\n  theme_name: string;\n  title: string;\n  video_limit: number;\n  allow_downloads?: boolean;\n  sort?: SortType;\n  direction?: SortDirection;\n  enable_search?: boolean;\n  enable_tags?: boolean;\n  enable_playlist?: boolean;\n  per_page?: number;\n}\n\nexport type GalleryAppearanceRule = {\n  id: string;\n  css: string;\n};\n\ntype Action =\n  | { type: `HYDRATE`; payload: GalleryResponse }\n  | { type: `EDIT_GALLERY_STATE`; payload: GalleryState }\n  | { type: `RESET_GALLERY_APPEARANCE` }\n  | { type: `UPDATE_GALLERY_APPEARANCE`; payload: ThemeSetting };\n\nconst initialState = {\n  appearanceRules: [],\n};\n\nconst convertToDashedAttribute = (attr: string) => {\n  let shimmedAttribute;\n\n  // backwards-compat for old gallery theme settings\n  // removes grid prefix from deprecated theme attributes\n  // for browser compatibility\n  if (attr === `gridColumnGap`) {\n    shimmedAttribute = `columnGap`;\n  } else if (attr === `gridRowGap`) {\n    shimmedAttribute = `rowGap`;\n  } else {\n    shimmedAttribute = attr;\n  }\n\n  return shimmedAttribute.replace(/[A-Z]/g, (a) => \"-\" + a.toLowerCase());\n};\n\nconst computeValue = (\n  type: ThemeSettingType,\n  transform: string = \"\",\n  value: string\n) => {\n  const suffix = type === \"numeric\" || type === \"slider\" ? \"px\" : \"\";\n\n  if (transform !== \"\") {\n    return `${transform.replace(/{{value}}/, value + suffix)}`;\n  } else {\n    return `${value}${suffix}`;\n  }\n};\n\nconst reducer = (state: GalleryState, action: Action) => {\n  switch (action.type) {\n    case \"HYDRATE\":\n    case `EDIT_GALLERY_STATE`: {\n      return {\n        ...state,\n        ...action.payload,\n      };\n    }\n\n    case `RESET_GALLERY_APPEARANCE`: {\n      return produce(state, (next) => {\n        next.appearanceRules = [];\n      });\n    }\n\n    case `UPDATE_GALLERY_APPEARANCE`: {\n      let rules: GalleryAppearanceRule[] = [];\n\n      const buildCSS = (\n        target: string,\n        attribute: string,\n        computedValue: string,\n        label: string\n      ) =>\n        `/* ${label}  */\n        ${\n          namespace ? \"#vimeography-gallery-\" + state.id : \"\"\n        }${target} { ${attribute}: ${computedValue}${\n          important ? \" !important;\" : \";\"\n        } }\n        `;\n\n      const {\n        id,\n        label,\n        type,\n        value,\n        properties,\n        namespace,\n        important,\n        expressions = [],\n      } = action.payload;\n\n      properties.map((property, index) => {\n        const computedValue = computeValue(type, property.transform, value);\n        const attribute = convertToDashedAttribute(property.attribute);\n\n        rules.push({\n          id: `${id}-property-${index}`,\n          css: buildCSS(property.target, attribute, computedValue, label),\n        });\n      });\n\n      expressions.map((expression, index) => {\n        const attribute = convertToDashedAttribute(expression.attribute);\n\n        let calculatedValue;\n\n        switch (expression.operator) {\n          case \"+\":\n            calculatedValue = Math.ceil(\n              parseInt(value) + eval(expression.value)\n            );\n            break;\n          case \"-\":\n            calculatedValue = Math.ceil(\n              parseInt(value) - eval(expression.value)\n            );\n            break;\n          case \"/\":\n            calculatedValue = Math.ceil(\n              parseInt(value) / eval(expression.value)\n            );\n            break;\n          case \"*\":\n            calculatedValue = Math.ceil(\n              parseInt(value) * eval(expression.value)\n            );\n            break;\n        }\n\n        const computedValue = computeValue(\n          type,\n          expression.transform,\n          calculatedValue.toString()\n        );\n\n        rules.push({\n          id: `${id}-expression-${index}`,\n          css: buildCSS(expression.target, attribute, computedValue, label),\n        });\n      });\n\n      return produce(state, (next) => {\n        rules.map((rule) => {\n          const index = next.appearanceRules.findIndex(\n            (el) => el.id === rule.id\n          );\n\n          if (index === -1) {\n            next.appearanceRules.push(rule);\n          } else {\n            next.appearanceRules[index] = rule;\n          }\n        });\n      });\n    }\n\n    default:\n      // console.log(`unknown action type: ${action.type}`);\n      return state;\n  }\n};\n\nconst GalleryProvider = (props: GalleryProviderProps) => {\n  const themesCtx = React.useContext(ThemesContext);\n  const [state, dispatch] = React.useReducer(reducer, initialState);\n\n  const { isLoading, error, data } = useQuery(\n    [`galleries`, props.id],\n    () => {\n      return fetch(\n        window.vimeographyApiSettings.root +\n          `vimeography/v1/galleries/${props.id}`\n      ).then((res) => {\n        return res.json();\n      });\n    },\n    { staleTime: Infinity }\n  );\n\n  React.useEffect(() => {\n    if (!data) return;\n    dispatch({ payload: data, type: \"HYDRATE\" });\n  }, [data]);\n\n  // Detect any theme CSS customizations on load and\n  // send them to the themes context to hydrate\n  // the appearance controls with the correct values\n  React.useEffect(() => {\n    if (!data) return;\n    if (!themesCtx.data) return;\n\n    const activeTheme: Theme = themesCtx.data.find(\n      (theme: Theme) => theme.name === data.theme_name\n    );\n\n    if (!activeTheme) return;\n\n    const customStyle = document.getElementById(\n      `vimeography-gallery-${props.id}-custom-css`\n    );\n\n    if (!customStyle) return;\n    console.log(`custom style found!`);\n    console.log(customStyle);\n    console.log(`rules:`);\n    console.dir(customStyle.sheet.cssRules);\n    // since it is possible that the element it hidden (as in a modal)\n    // try to get the defined value based on the loaded stylesheet\n    activeTheme.settings.map((setting) => {\n      setting.properties.map((prop) => {\n        // build the expected selector\n\n        // accounts for incorrect single-colon pseudo selectors in any theme settings\n        // https://regex101.com/r/zzlv1J/1\n        const modifiedTarget = prop.target.replace(\n          /([^:])(:)([^:])/g,\n          \"$1::$3\"\n        );\n\n        const selectorToMatch = setting.namespace\n          ? `#vimeography-gallery-${props.id}${modifiedTarget}`\n          : modifiedTarget;\n\n        console.log(\n          `attempting to match theme setting in custom stylesheet rules: ${selectorToMatch}`\n        );\n\n        // search the stylesheet for the selector\n        for (let rule of customStyle.sheet.cssRules) {\n          // need to find a match for the target defined in our theme settings\n\n          if (rule.selectorText === selectorToMatch) {\n            // get the value for the current prop attribute\n\n            console.log(`we have a match`);\n\n            let value = rule.style.getPropertyValue(\n              convertToDashedAttribute(prop.attribute)\n            );\n\n            // if no value, no customization found for this particular setting\n            if (!value) continue;\n\n            // console.log(`value found for ${selectorToMatch}!`);\n            // console.log(value);\n\n            // check if it needs to be un-transformed to extract the value\n            if (prop.transform) {\n              // console.log(\n              //   `extracting value from transform ${prop.transform}`\n              // );\n\n              const searchTerm = `{{value}}`;\n\n              // find the index of `{{value}}` in the transform\n              const tokenIndex = prop.transform.indexOf(searchTerm);\n\n              // find the characters which appear after the searchTerm in the transform\n              const terminator = prop.transform.substr(\n                tokenIndex + searchTerm.length\n              );\n\n              // get the index of the terminating characters within the existing customized css value\n              const terminatorIndex = value.indexOf(terminator);\n\n              // pull the value out of the string\n              const extractedValue = value.substring(\n                tokenIndex,\n                terminatorIndex\n              );\n\n              // console.log(\n              //   `extracted ${extractedValue} as the value based on the transform`\n              // );\n\n              value = extractedValue;\n            }\n\n            // reformat the incoming `action.payload.value` to the expected format for the ui control based on the settings type `setting.type`\n\n            let computedValue;\n\n            // console.log(setting);\n\n            switch (setting.type) {\n              case \"colorpicker\": {\n                // { r: 51, g: 51, b: 51, a: 1 } react-color may already convert this for us, test!\n                computedValue = value;\n                break;\n              }\n\n              case \"numeric\":\n              case \"slider\": {\n                // must be a number\n                const strippedValue = value.replace(\"px\", \"\");\n                const convertedValue = Math.ceil(strippedValue);\n\n                computedValue = convertedValue;\n                break;\n              }\n\n              default: {\n                computedValue = value;\n                break;\n              }\n            }\n\n            console.log(`updating value for ${setting.id} to ${computedValue}`);\n\n            // update the default `activeTheme`s `setting.value` for `setting.id` to the determined configured `value`\n            themesCtx.dispatch({\n              type: `THEME.SETTING.UPDATE_DEFAULT_VALUE`,\n              payload: {\n                themeName: activeTheme.name,\n                settingId: setting.id,\n                value: computedValue,\n              },\n            });\n\n            dispatch({\n              type: `UPDATE_GALLERY_APPEARANCE`,\n              payload: { ...setting, value: computedValue },\n            });\n          }\n        }\n      });\n    });\n\n    // Remove the style that came from the server since we'll be\n    // generating a new one in the client anyway\n    customStyle.remove();\n  }, [data, themesCtx]);\n\n  return (\n    <GalleryContext.Provider\n      value={{\n        isLoading,\n        error,\n        data,\n        state,\n        dispatch,\n      }}\n    >\n      <Helmet>\n        <script type=\"text/javascript\">{`!function(e,t,n){function a(){var e=t.getElementsByTagName(\"script\")[0],n=t.createElement(\"script\");n.type=\"text/javascript\",n.async=!0,n.src=\"https://beacon-v2.helpscout.net\",e.parentNode.insertBefore(n,e)}if(e.Beacon=n=function(t,n,a){e.Beacon.readyQueue.push({method:t,options:n,data:a})},n.readyQueue=[],\"complete\"===t.readyState)return a();e.attachEvent?e.attachEvent(\"onload\",a):e.addEventListener(\"load\",a,!1)}(window,document,window.Beacon||function(){});`}</script>\n        <script type=\"text/javascript\">{`window.Beacon('init', 'f7cb9d02-1ec7-4320-ad10-fcbc85e4d544')`}</script>\n        <style\n          type=\"text/css\"\n          id={`vimeography-gallery-${props.id}-custom-css-preview`}\n        >{`\n      ${state.appearanceRules.map((rule) => rule.css).join(\"\\r\\n\\r\\n\")}\n    `}</style>\n      </Helmet>\n\n      {props.children}\n    </GalleryContext.Provider>\n  );\n};\n\nexport default GalleryProvider;\n"],"sourceRoot":""}